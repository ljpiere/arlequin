<?xml version='1.1' encoding='UTF-8'?>
<Tag plugin="workflow-support@976.vb_d9493c2eb_09">
  <node class="cps.n.StepAtomNode" plugin="workflow-cps@4183.v94b_6fd39da_c1">
    <parentIds>
      <string>13</string>
    </parentIds>
    <id>14</id>
    <descriptorId>org.jenkinsci.plugins.workflow.steps.durable_task.ShellStep</descriptorId>
  </node>
  <actions>
    <cps.a.ArgumentsActionImpl plugin="workflow-cps@4183.v94b_6fd39da_c1">
      <arguments>
        <entry>
          <string>script</string>
          <string>
          set -eu
          CID_PY=$(cat .cid_py)

          # Espera MLflow (hasta 20 intentos)
          for i in $(seq 1 20); do
            if docker exec -i &quot;$CID_PY&quot; sh -lc &quot;curl -sS -I ${MLFLOW_URL} &gt;/dev/null 2&gt;&amp;1&quot;; then
              echo &quot;[OK] MLflow responde&quot;; break
            fi
            echo &quot;[wait] MLflow a√∫n no responde (${i}/20)&quot;; sleep 3
            [ $i -eq 20 ] &amp;&amp; { echo &quot;[ERROR] MLflow no responde en ${MLFLOW_URL}&quot;; exit 2; }
          done

          # Instala deps si faltan
          docker exec -i &quot;$CID_PY&quot; sh -lc &apos;
            python3 - &lt;&lt;PY
try:
  import mlflow, sklearn, pandas, numpy
  print(&quot;deps OK&quot;)
except Exception:
  raise SystemExit(1)
PY
          &apos; || docker exec -i &quot;$CID_PY&quot; sh -lc &apos;
            apt-get update &amp;&amp; apt-get install -y --no-install-recommends procps curl || true
            python3 -m pip install --no-cache-dir -r /scripts/requirements.txt
          &apos;
        </string>
        </entry>
      </arguments>
      <sensitiveVariables/>
      <isUnmodifiedBySanitization>true</isUnmodifiedBySanitization>
    </cps.a.ArgumentsActionImpl>
    <wf.a.TimingAction plugin="workflow-api@1384.vdc05a_48f535f">
      <startTime>1756519895351</startTime>
    </wf.a.TimingAction>
    <s.a.LogStorageAction/>
  </actions>
</Tag>