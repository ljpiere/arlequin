pipeline {
  agent any
  stages {
    stage('Train with Spark') {
      steps {
        sh '''
        echo "Running spark-submit for trainingâ€¦"
        docker compose exec -T pyspark-client bash -lc "
          spark-submit --master spark://spark-master:7077 \
            --conf spark.hadoop.fs.defaultFS=hdfs://namenode:9000 \
            /scripts/train_model.py
        "
        '''
      }
    }
  }
  post {
    always {
      echo 'Done.'
    }
  }
}
